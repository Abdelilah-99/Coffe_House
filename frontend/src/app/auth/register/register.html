<div class="register-container">
  <div class="decorative-left"></div>
  <div class="decorative-right"></div>

  <div class="geometric-shape star-8"></div>
  <div class="geometric-shape star-4"></div>
  <div class="geometric-shape hexagon"></div>
  <div class="geometric-shape circle-pattern"></div>

  <div class="container-fluid">
    <div class="row justify-content-center align-items-center min-vh-100">
      <div class="col-12 col-sm-10 col-md-8 col-lg-6 col-xl-5">
        <div class="register-card">
          <div class="register-header">
            <h2><i class="bi bi-stars me-2"></i>Rejoignez-nous</h2>
            <p>Créez votre compte pour commencer</p>
            <div class="step-indicator">
              <div class="step" [class.active]="currentStep === 1" [class.completed]="currentStep > 1">
                <div class="step-number">1</div>
                <span class="step-label">Informations</span>
              </div>
              <div class="step-divider"></div>
              <div class="step" [class.active]="currentStep === 2">
                <div class="step-number">2</div>
                <span class="step-label">Sécurité</span>
              </div>
            </div>
          </div>
          <form (ngSubmit)="onRegister()" class="register-form" novalidate>
            <div *ngIf="currentStep === 1" class="form-step">
              <div class="row">
                <div class="col-md-6 mb-3 form-group">
                  <label for="firstname" class="form-label">
                    <i class="bi bi-person me-2"></i>Prénom
                  </label>
                  <input type="text" maxlength="15" id="firstname" [(ngModel)]="firstname" name="firstname"
                    placeholder="Saisissez votre prénom" required class="form-control form-input">
                  <div class="char-count-hint">
                    <span class="char-count">{{ (firstname.length || 0) }}/15</span>
                  </div>
                </div>

                <div class="col-md-6 mb-3 form-group">
                  <label for="lastname" class="form-label">
                    <i class="bi bi-person-check me-2"></i>Nom de famille
                  </label>
                  <input type="text" maxlength="15" id="lastname" [(ngModel)]="lastname" name="lastname"
                    placeholder="Saisissez votre nom de famille" required class="form-control form-input">
                  <div class="char-count-hint">
                    <span class="char-count">{{ (lastname.length || 0) }}/15</span>
                  </div>
                </div>
              </div>

              <div class="mb-3 form-group">
                <label for="username" class="form-label">
                  <i class="bi bi-at me-2"></i>Nom d'utilisateur
                </label>
                <input type="text" maxlength="50" id="username" [(ngModel)]="username" name="username"
                  placeholder="Choisissez un nom d'utilisateur" required class="form-control form-input">
                <div class="char-count-hint">
                  <span class="char-count">{{ (username.length || 0) }}/50</span>
                </div>
              </div>

              <div class="mb-3 form-group">
                <label for="email" class="form-label">
                  <i class="bi bi-envelope-heart me-2"></i>Adresse email
                </label>
                <input type="email" maxlength="20" id="email" [(ngModel)]="email" name="email"
                  placeholder="Saisissez votre adresse email" required class="form-control form-input">
              </div>

              <div class="d-grid gap-2">
                <button type="button" (click)="nextStep()" [disabled]="!isStep1Valid()" class="btn register-button"
                  [class.disabled]="!isStep1Valid()">
                  <span>Suivant</span>
                  <i class="bi bi-arrow-right ms-2"></i>
                </button>
              </div>
            </div>

            <div *ngIf="currentStep === 2" class="form-step">
              <div class="mb-3 form-group">
                <label for="password" class="form-label">
                  <i class="bi bi-shield-lock me-2"></i>Mot de passe
                </label>
                <input type="password" maxlength="10" id="password" [(ngModel)]="password" name="password"
                  placeholder="Créez un mot de passe sécurisé" required class="form-control form-input">
              </div>

              <div class="mb-4 form-group">
                <label for="profileImage" class="form-label">
                  <i class="bi bi-camera me-2"></i>Photo de profil (Optionnel)
                </label>
                <div class="file-input-wrapper">
                  <input type="file" id="profileImage" (change)="onFileSelected($event)" accept="image/*"
                    class="form-control file-input">
                  <label for="profileImage" class="file-input-label btn btn-outline-secondary"
                    *ngIf="!profileImagePreview">
                    <i class="bi bi-cloud-upload me-2"></i>
                    <span class="file-input-text">Choisir une photo</span>
                  </label>
                  <div *ngIf="message">{{message}}</div>
                </div>
                <div *ngIf="profileImagePreview" class="profile-image-preview">
                  <img [src]="profileImagePreview" alt="Profile Preview">
                  <button type="button" class="remove-profile-btn" (click)="removeProfileImage()">
                    <i class="bi bi-trash"></i> Supprimer
                  </button>
                </div>
              </div>

              <div class="d-grid gap-2">
                <button type="submit" [disabled]="!isStep2Valid()" class="btn register-button"
                  [class.disabled]="!isStep2Valid()">
                  <i class="bi bi-person-plus-fill me-2"></i>Créer mon compte
                </button>
                <button type="button" (click)="previousStep()" class="btn btn-secondary back-button">
                  <i class="bi bi-arrow-left me-2"></i>Retour
                </button>
              </div>
            </div>
          </form>


          <div class="login-link">
            <p class="text-muted">Vous avez déjà un compte ?
              <a routerLink="/login" class="login-link-text text-decoration-none">
                <i class="bi bi-door-open me-1"></i>Se connecter
              </a>
            </p>
          </div>
          <div class="alert alert-danger error-message" *ngIf="message" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>{{ message }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>