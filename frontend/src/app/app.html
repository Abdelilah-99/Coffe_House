<div class="components">
    <div class="sidebar-overlay" *ngIf="sidebarOpen" (click)="closeSidebar()"></div>

    <aside class="sidebar" [class.open]="sidebarOpen" *ngIf="showNavbar">
        <div class="sidebar-header">
            <h2>Menu</h2>
            <button class="sidebar-close" (click)="toggleSidebar()">Ã—</button>
        </div>
        <nav class="sidebar-nav">
            <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="sidebar-link"
                (click)="closeSidebar()">
                <span>Home</span>
            </a>
            <a routerLink="/me" routerLinkActive="active" class="sidebar-link" (click)="closeSidebar()">
                <span>My Profile</span>
            </a>
            <a routerLink="/notification" routerLinkActive="active" class="sidebar-link" (click)="closeSidebar()">
                <span>Notifications</span>
                <span class="sidebar-badge" *ngIf="count">{{ count }}</span>
            </a>
            <a *ngIf="isAdmin()" routerLink="/admin" routerLinkActive="active" class="sidebar-link"
                (click)="closeSidebar()">
                <span>Admin Panel</span>
            </a>
            <div class="sidebar-divider"></div>

            <div class="sidebar-section">
                <h3 class="sidebar-section-title">Following</h3>
                <div class="following-list">
                    <p *ngIf="loadingFollowing" class="following-loading">Loading...</p>
                    <p *ngIf="!loadingFollowing && followingList.length === 0" class="following-empty">Not following
                        anyone yet</p>
                    <div *ngFor="let user of followingList" class="following-item"
                        (click)="navigateToProfile(user.uuid)">
                        <img [src]="'http://localhost:8080/' +  user.profileImagePath" [alt]="user.username"
                            class="following-avatar">
                        <div class="following-info">
                            <p class="following-name">{{ user.firstName }} {{ user.lastName }}</p>
                            <p class="following-username">@{{ user.username }}</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="sidebar-divider"></div>
            <button class="sidebar-link logout-btn" (click)="logout()">
                <span>Logout</span>
            </button>
        </nav>
    </aside>

    <nav class="navbar" *ngIf="showNavbar">
        <div class="navbar-container">
            <div class="navbar-left">
                <button class="hamburger-btn" (click)="toggleSidebar()">
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                </button>

                <div class="navbar-brand">
                    <a href="/" class="brand-link">
                        <img class="coffe-house-icon" src="/coffe-house.png" alt="Coffee House">
                        <span class="brand-name">Coffee House</span>
                    </a>
                </div>

                <div class="navbar-search-inline">
                    <app-searchbar (closeSearch)="toggleSearch()"></app-searchbar>
                </div>
            </div>

            <div class="navbar-actions">
                <div class="profile-menu" *ngIf="userProfile">
                    <button class="profile-btn" (click)="toggleProfileDropdown()">
                        <img [src]="'http://localhost:8080/' +  userProfile.profileImagePath" alt="Profile"
                            class="profile-avatar">
                    </button>
                    <div class="profile-dropdown" [class.show]="profileDropdownOpen">
                        <div class="profile-dropdown-header" *ngIf="userProfile">
                            <img [src]="'http://localhost:8080/' +  userProfile.profileImagePath" alt="Profile"
                                class="profile-dropdown-avatar">
                            <div class="profile-dropdown-info">
                                <p class="profile-dropdown-name">{{ userProfile.firstName }} {{ userProfile.lastName }}
                                </p>
                                <p class="profile-dropdown-username">@{{ userProfile.username }}</p>
                            </div>
                        </div>
                        <div class="profile-dropdown-divider"></div>
                        <a routerLink="/me" class="profile-dropdown-link" (click)="toggleProfileDropdown()">
                            My Profile
                        </a>
                        <a routerLink="/notification" class="profile-dropdown-link" (click)="toggleProfileDropdown()">
                            Notifications
                            <span class="dropdown-badge" *ngIf="count && count.count > 0">{{ count.count }}</span>
                        </a>
                        <a *ngIf="isAdmin()" routerLink="/admin" class="profile-dropdown-link"
                            (click)="toggleProfileDropdown()">
                            Admin Panel
                        </a>
                        <div class="profile-dropdown-divider"></div>
                        <button class="profile-dropdown-link logout-link" (click)="logout()">
                            Logout
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <router-outlet />
</div>